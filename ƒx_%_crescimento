DEFINE

FUNCTION _CRESCIMENTO = (MEDIDA : scalar expr, PERIODO : string val) =>

VAR vATUAL = MEDIDA
VAR vANTERIOR = 
	SWITCH(
		TRUE(),
		PERIODO = "YoY", CALCULATE(MEDIDA, DATEADD(dCALENDARIO[Data],-1,YEAR)),
		PERIODO = "MoM", CALCULATE(MEDIDA, DATEADD(dCALENDARIO[Data],-1,MONTH)),
		PERIODO = "QoQ", CALCULATE(MEDIDA, DATEADD(dCALENDARIO[Data],-1,QUARTER)),
		PERIODO = "WoW", CALCULATE(MEDIDA, DATEADD(dCALENDARIO[Data],-7,DAY)),
		BLANK()
	)

VAR TEMDADOS = NOT(ISBLANK(vATUAL) || ISBLANK(vANTERIOR))

RETURN
	IF(TEMDADOS,
		DIVIDE(vATUAL - vANTERIOR,vANTERIOR),
		BLANK()
	)
